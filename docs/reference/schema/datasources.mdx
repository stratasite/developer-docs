# datasources.yml Schema

Datasource configuration file schema.

## Overview

`datasources.yml` defines database connections for your project.

## Location

Root of your project directory.

## Schema

```yaml
datasource_key:
  adapter: string              # Required: Adapter name
  name: string                 # Required: Display name
  description: string          # Optional: Description
  tier: string                 # Optional: hot, warm, cold (default: warm)
  query_timeout: integer       # Optional: Query timeout in seconds (default: 3600)
  
  # Adapter-specific fields (see adapter docs)
  host: string                 # PostgreSQL, MySQL, SQL Server, Trino, Druid
  port: integer                # PostgreSQL, MySQL, SQL Server, Trino, Druid
  database: string             # PostgreSQL, MySQL, SQL Server, DuckDB
  schema: string               # PostgreSQL, Snowflake, SQL Server, Trino
  username: string             # PostgreSQL, MySQL, SQL Server, Trino
  # password: (set via strata datasource auth)
  
  # Snowflake-specific
  account_identifier: string
  warehouse: string
  role: string
  auth_mode: string            # pat, kp, oauth
  
  # Athena-specific
  region: string
  s3_output_location: string
  catalog: string
  
  # DuckDB-specific
  file_path: string
  
  # SSL/TLS
  ssl: boolean                 # PostgreSQL, MySQL, Trino
  
  # Azure
  azure: boolean               # SQL Server
```

## Required Fields

### adapter

Database adapter name.

```yaml
adapter: postgres
```

**Supported adapters:**
- `postgres`
- `snowflake`
- `mysql`
- `sqlserver`
- `athena`
- `trino`
- `duckdb`
- `druid`

### name

Display name for the datasource.

```yaml
name: Production Warehouse
```

## Optional Fields

### description

Datasource description.

```yaml
description: Main production data warehouse
```

### tier

Performance tier influencing query routing.

```yaml
tier: hot  # hot, warm, cold
```

**Options:**
- `hot` - Fast, frequently accessed (highest priority)
- `warm` - Moderate performance
- `cold` - Archive/slow data (lowest priority)

**Default:** `warm`

### query_timeout

Maximum query execution time in seconds.

```yaml
query_timeout: 3600  # 1 hour
```

**Default:** `3600`

## Adapter-Specific Fields

See adapter-specific documentation:
- [PostgreSQL](/docs/reference/adapters/postgres)
- [Snowflake](/docs/reference/adapters/snowflake)
- [MySQL](/docs/reference/adapters/mysql)
- [SQL Server](/docs/reference/adapters/sqlserver)
- [Athena](/docs/reference/adapters/athena)
- [Trino](/docs/reference/adapters/trino)
- [DuckDB](/docs/reference/adapters/duckdb)
- [Druid](/docs/reference/adapters/druid)

## Credentials

Credentials are stored in `.strata` (not in `datasources.yml`):

```bash
strata datasource auth datasource_key
```

## Complete Examples

### PostgreSQL

```yaml
warehouse:
  adapter: postgres
  name: Production Warehouse
  tier: hot
  query_timeout: 3600
  host: db.example.com
  port: 5432
  database: analytics
  schema: public
  ssl: true
  username: strata_user
  # password: (set via strata datasource auth)
```

### Snowflake

```yaml
snowflake_dw:
  adapter: snowflake
  name: Snowflake Data Warehouse
  tier: hot
  account_identifier: xy12345
  database: ANALYTICS
  warehouse: COMPUTE_WH
  schema: PUBLIC
  role: ANALYST
  # Authentication: set via strata datasource auth
```

### Athena

```yaml
s3_data:
  adapter: athena
  name: S3 Data Lake
  tier: cold
  region: us-east-1
  s3_output_location: s3://my-bucket/athena-results/
  database: analytics
  catalog: awsdatacatalog
```

## Best Practices

1. **Use descriptive keys** - `warehouse` not `db1`
2. **Set appropriate tiers** - Match performance characteristics
3. **Never commit credentials** - Use `.strata` file
4. **Set timeouts** - Prevent long-running queries
5. **Use SSL in production** - Encrypt connections

## Next Steps

- [Add datasources](/docs/guides/datasources)
- [Read adapter documentation](/docs/reference/adapters)
- [Set credentials](/docs/reference/cli/datasource#auth)
