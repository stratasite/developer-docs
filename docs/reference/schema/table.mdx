# Table Model Schema (tbl.*.yml)

Complete schema for semantic table model files.

## Overview

Table models define semantic metadata for physical database tables.

## File Pattern

`models/**/tbl.{table_name}.yml`

## Schema

```yaml
# Required
datasource: string             # Datasource key or name
name: string                   # Logical table name (unique within datasource)
physical_name: string          # Physical table name in database
cost: integer                  # Cost number (lower = preferred)
fields: array                  # Array of field definitions

# Optional
snapshot_date: string          # Snapshot date dimension name
tags: array                    # Metadata tags
partition: array               # Partition constraints
imports: array                 # Field import paths
```

## Required Fields

### datasource

Datasource key or name this table belongs to.

```yaml
datasource: tpcds
```

### name

Logical name for the table. Must be unique within datasource.

```yaml
name: Store Sales
```

### physical_name

Physical table name in database. Can include schema/catalog prefix.

```yaml
physical_name: store_sales
# Or with schema:
physical_name: sales.orders
```

### cost

Numeric value influencing table selection. Lower cost = preferred.

```yaml
cost: 100
```

**Guidelines:**
- Dimension tables: `10`
- Fact tables: `100`
- Hot tier: Lower cost
- Cold tier: Higher cost

### fields

Array of dimension and measure field definitions.

```yaml
fields:
  - type: dimension
    name: Order ID
    data_type: integer
    expression:
      sql: order_id

  - type: measure
    name: Total Revenue
    data_type: decimal
    expression:
      sql: sum(amount)
```

[See field schema â†’](#field-schema)

## Optional Fields

### snapshot_date

For snapshot tables, specify the date dimension.

```yaml
snapshot_date: Date
```

Enables snapshot measures (beginning/ending).

### tags

Metadata tags for organization.

```yaml
tags:
  - marketing
  - operations
```

### partition

Data availability constraints.

```yaml
partitions:
  - dimension: Order Date
    predicate: between
    filter_value: 24m
    filter_value_end: 1d
    description: "Rolling 2 year window"
```

**Predicates:**
- `between` - Date range
- `in_list` - List of values

### imports

Import field definitions from other files.

```yaml
imports:
  - ../common/common_dates.yml
  - ../common/geo_dimensions.yml
```

## Field Schema

### Dimension Field

```yaml
- type: dimension
  name: string                 # Required
  description: string          # Optional
  data_type: string            # Required: string, integer, bigint, decimal, date, date_time, boolean, binary
  hidden: boolean              # Optional
  display_type: string         # Optional: default, html, url, email, phone_number, image
  formatter: string            # Optional: currency_usd, percent, thousands, millions, billions, custom
  disable_value_listing: boolean # Optional (dimensions only)
  value_list_size: integer     # Optional (dimensions only, default: 1000)
  grains: array                # Optional (date/date_time only)
  expression: object           # Required
    primary_key: boolean        # Optional
    lookup: boolean             # Optional
    array: boolean              # Optional
    sql: string                 # Required
  exclusion_type: string       # Optional: exclude, exclude_all_except, exclude_all
  exclusions: array            # Optional (required when exclusion_type set)
  inclusions: object           # Optional
  snapshot: string              # Optional: ending, beginning (measures only)
```

### Measure Field

```yaml
- type: measure
  name: string                 # Required
  description: string          # Optional
  data_type: string            # Required: integer, bigint, decimal, date, date_time
  hidden: boolean              # Optional
  formatter: string            # Optional
  expression: object           # Required
    sql: string                 # Required (must include aggregation)
  exclusion_type: string       # Optional
  exclusions: array            # Optional
  inclusions: object           # Optional
  snapshot: string              # Optional: ending, beginning
```

## Complete Example

```yaml
name: Store Sales
physical_name: store_sales
datasource: tpcds
cost: 100

imports:
  - ../common/common_dates.yml

partitions:
  - dimension: Order Date
    predicate: between
    filter_value: 24m
    filter_value_end: 1d
    description: "Rolling 2 year window"

fields:
  - type: dimension
    name: Store Ticket number
    description: Actual ticket number of an order
    data_type: integer
    expression:
      primary_key: true
      sql: ss_tickent_number

  - type: measure
    name: Store Quantity
    description: Quantity of items sold
    data_type: integer
    expression:
      sql: sum(ss_quantity)

  - type: measure
    name: Store Sales Price
    description: Actual sales price
    data_type: decimal
    formatter: currency_usd
    expression:
      sql: sum(ss_sales_price)
```

## Best Practices

1. **Use descriptive names** - Business-friendly table names
2. **Set appropriate costs** - Lower for dimensions, higher for facts
3. **Import common fields** - Reuse field definitions
4. **Define partitions** - Help planner route queries
5. **Add descriptions** - Document table purpose

## Next Steps

- [Learn about tables](/docs/semantic-model/tables)
- [Read about fields](/docs/semantic-model/fields/dimensions)
- [Explore field options](/docs/semantic-model/fields)
